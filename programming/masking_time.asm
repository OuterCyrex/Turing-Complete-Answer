# modulo operations with powers of 2 are related to bitwise AND
# for instance, x % 4 is simply x & 3, as it only keeps the lowest two bits

in_to_reg0
reg0_to_reg1
3
reg0_to_reg2
and
reg3_to_out